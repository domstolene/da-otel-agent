<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{base}">

<head>
    <title>Agent Configuration</title>
    <style>
        label {
            font-weight: bold;
        }
    </style>
</head>

<body>
    <div layout:fragment="content">
        <div class="container mt-4">
            <h1 th:text="${name}"></h1>
            <hr>
            <p><b>Read Only:</b> <span th:text="${config.readOnly}">false</span></p>
            <p><b>Last changed:</b> <span
                    th:text="${#dates.format(config.timestamp, 'yyyy-MM-dd HH:mm:ss')}">Timestamp</span></p>
            <div>
                <form action="TODO">

                    <div>
                        <label th:for="'sampler-' + ${config.serviceName}">Sampler: </label>
                        <select class="form-select" th:id="'sampler-' + ${config.serviceName}"
                            th:disabled="${config.readOnly}" th:name="sampler">
                            <option
                                th:each="samplerType : ${T(no.domstol.otel.agent.service.AgentConfiguration.SamplerType).values()}"
                                th:value="${samplerType}" th:text="${samplerType}"
                                th:selected="${config.sampler == samplerType}">
                            </option>
                        </select>
                    </div>

                    <div>
                        <label th:for="'ratio-' + ${config.serviceName}">Sample ratio:</label>
                        <input type="number" step="0.001" min="0" max="1" th:id="'ratio-' + ${config.serviceName}"
                            class="form-control" th:name="sampleRatio" th:value="${config.sampleRatio}"
                            th:disabled="${config.readOnly}" />
                    </div>

                    <div>
                        <label style="display: block;" for="rules-textarea" class="form-label">Rules:</label>
                        <textarea id="rules-textarea" class="form-control" rows="10"
                            th:text="${@configurationRenderer.getFormattedRules(config)}"></textarea>
                        <p th:if="${config.rules == null}">No rules defined.</p>
                    </div>

                    <button type="submit" th:disabled="${config.readOnly}" class="btn btn-primary float-right">Update
                        agent configuration</button>
                </form>
            </div>
        </div>
    </div>
</body>